<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Doce Sabor Caseiro</title>
  <style>
    :root {
      --rosa: #f28ab2;
      --fundo-claro: #fff0f5;
      --fundo-escuro: #1c1c1c;
      --texto-claro: #333;
      --texto-escuro: #f5f5f5;
    }

    * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; }
    body {
      background: var(--fundo-claro);
      color: var(--texto-claro);
      transition: background 0.3s, color 0.3s;
    }

    body.dark {
      background: var(--fundo-escuro);
      color: var(--texto-escuro);
    }

    .splash {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      height: 100vh; background: var(--rosa); color: white; text-align: center;
    }

    .splash h1 { font-size: 3rem; margin-bottom: 20px; }
    .splash button {
      background: white; color: var(--rosa); font-size: 1.2rem;
      border: none; padding: 12px 24px; border-radius: 8px;
      cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .container { display: none; padding: 20px; }

    nav {
      display: flex; justify-content: space-around;
      background: var(--rosa); padding: 12px 0; position: sticky; top: 0;
      z-index: 10;
    }

    nav button {
      background: none; border: none; color: white; font-size: 1rem;
      font-weight: bold; cursor: pointer;
    }

    .modo-escuro-btn {
      position: absolute; top: 12px; right: 12px;
      background: black; color: white; padding: 5px 10px;
      border-radius: 8px; font-size: 0.8rem; border: none; cursor: pointer;
    }

    section {
      display: none; background: white; padding: 20px;
      margin-top: 20px; border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    body.dark section {
      background: #2e2e2e;
    }

    section.active { display: block; }

    h2 {
      color: var(--rosa); margin-bottom: 16px;
      border-bottom: 2px solid var(--rosa); padding-bottom: 4px;
    }

    input, select {
      width: 100%; padding: 10px; margin-bottom: 12px;
      border: 1px solid #ccc; border-radius: 8px;
    }

    button.save {
      background: var(--rosa); color: white; padding: 10px 20px;
      border: none; border-radius: 8px; cursor: pointer; font-weight: bold;
    }

    .listagem {
      margin-top: 20px; border-top: 1px dashed #aaa; padding-top: 10px;
    }

    ul { list-style: none; padding: 0; }
    ul li {
      background: #ffe6ec; margin-bottom: 10px; padding: 10px;
      border-radius: 6px;
      display: flex; justify-content: space-between; align-items: center;
    }

    body.dark ul li {
      background: #3a3a3a;
      color: #eee;
    }

    .info { flex: 1; }
    .botoes button {
      margin-left: 5px; padding: 4px 8px; font-size: 0.8rem;
      border: none; border-radius: 4px; cursor: pointer;
    }

    .editar { background: #ffc107; color: #000; }
    .excluir { background: #dc3545; color: #fff; }

    .filtros {
      display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;
    }
    .financeiro p { margin: 6px 0; }
  </style>
</head>
<body>

<div class="splash" id="splash">
  <h1>üç∞ Doce Sabor Caseiro</h1>
  <button onclick="entrar()">Entrar</button>
</div>

<div class="container" id="app">
  <button class="modo-escuro-btn" onclick="alternarModo()">üåô Modo Escuro</button>
  <nav>
    <button onclick="mostrar('clientes')">üë§ Clientes</button>
    <button onclick="mostrar('pedidos')">üßÅ Pedidos</button>
    <button onclick="mostrar('despesas')">üí∏ Despesas</button>
    <button onclick="mostrar('estoque')">üì¶ Estoque</button>
    <button onclick="mostrar('financeiro')">üìä Financeiro</button>
  </nav>

  <!-- Se√ß√£o Clientes -->
  <section id="clientes" class="active">
    <h2>üë§ Cadastro de Clientes</h2>
    <input id="clienteNome" placeholder="Nome">
    <input id="clienteTelefone" placeholder="Telefone">
    <input id="clienteEndereco" placeholder="Endere√ßo">
    <button class="save" onclick="salvarCliente()">Salvar</button>

    <div class="listagem">
      <input id="buscaCliente" placeholder="üîç Buscar cliente..." oninput="listarClientes()">
      <ul id="listaClientes"></ul>
    </div>
  </section>

  <!-- Se√ß√£o Pedidos -->
  <section id="pedidos">
    <h2>üßÅ Pedidos</h2>
    <input id="pedidoCliente" placeholder="Cliente">
    <input id="tipoProduto" placeholder="Produto">
    <input id="valorPedido" type="number" placeholder="Valor (R$)">
    <input id="dataEntrega" type="date" placeholder="Data de Entrega">
    <select id="formaEntrega">
      <option value="Entregar">Entregar</option>
      <option value="Retirar">Retirar</option>
    </select>
    <button class="save" onclick="salvarPedido()">Salvar Pedido</button>

    <div class="filtros">
      <input id="filtroPedido" placeholder="üîç Filtrar por nome ou produto..." oninput="listarPedidos()">
      <select id="ordenarPedido" onchange="listarPedidos()">
        <option value="recente">Mais recente</option>
        <option value="alfabetico">A-Z</option>
      </select>
    </div>
    <ul id="listaPedidos"></ul>
  </section>

  <!-- Se√ß√£o Despesas -->
  <section id="despesas">
    <h2>üí∏ Despesas</h2>
    <select id="tipoDespesa">
      <option>Mercadorias</option>
      <option>Loja</option>
      <option>Pessoais</option>
    </select>
    <input id="valorDespesa" type="number" placeholder="Valor (R$)">
    <button class="save" onclick="salvarDespesa()">Salvar</button>
    <ul id="listaDespesas"></ul>
  </section>

  <!-- Se√ß√£o Estoque -->
  <section id="estoque">
    <h2>üì¶ Estoque</h2>
    <input id="produtoNome" placeholder="Produto">
    <input id="produtoQtd" type="number" placeholder="Quantidade">
    <button class="save" onclick="adicionarProduto()">Adicionar</button>

    <input id="filtroEstoque" placeholder="üîç Buscar produto..." oninput="listarEstoque()">
    <ul id="listaEstoque"></ul>
  </section>

  <!-- Se√ß√£o Financeiro -->
  <section id="financeiro" class="financeiro">
    <h2>üìä Financeiro</h2>
    <p><strong>Ganhos:</strong> R$ <span id="ganhos">0.00</span></p>
    <p><strong>Gastos:</strong> R$ <span id="gastos">0.00</span></p>
    <p><strong>Lucros:</strong> R$ <span id="lucros">0.00</span></p>
    <p><em>üìÖ Relat√≥rio mensal ser√° gerado automaticamente.</em></p>
  </section>
</div>

<script>
  let clienteEditando = null;

  function entrar() {
    document.getElementById('splash').style.display = 'none';
    document.getElementById('app').style.display = 'block';
    atualizarTudo();
  }

  function alternarModo() {
    document.body.classList.toggle('dark');
  }

  function mostrar(secao) {
    document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
    document.getElementById(secao).classList.add('active');
  }

  function salvarCliente() {
    const nome = clienteNome.value.trim();
    const telefone = clienteTelefone.value.trim();
    const endereco = clienteEndereco.value.trim();
    if (!nome || !telefone || !endereco) return alert('Preencha todos os campos');
    let clientes = JSON.parse(localStorage.getItem('clientes') || '[]');
    if (clienteEditando !== null) {
      clientes[clienteEditando] = { nome, telefone, endereco };
      clienteEditando = null;
    } else {
      clientes.push({ nome, telefone, endereco });
    }
    localStorage.setItem('clientes', JSON.stringify(clientes));
    clienteNome.value = clienteTelefone.value = clienteEndereco.value = '';
    listarClientes();
  }

  function listarClientes() {
    const termo = document.getElementById('buscaCliente').value.toLowerCase();
    const lista = document.getElementById('listaClientes');
    lista.innerHTML = '';
    const clientes = JSON.parse(localStorage.getItem('clientes') || '[]');
    clientes.filter(c => c.nome.toLowerCase().includes(termo)).forEach((c, i) => {
      const li = document.createElement('li');
      const div = document.createElement('div');
      div.className = 'info';
      div.textContent = `${c.nome} - ${c.telefone} (${c.endereco})`;

      const acoes = document.createElement('div');
      acoes.className = 'botoes';

      const btnEditar = document.createElement('button');
      btnEditar.className = 'editar';
      btnEditar.textContent = 'Editar';
      btnEditar.onclick = () => {
        clienteNome.value = c.nome;
        clienteTelefone.value = c.telefone;
        clienteEndereco.value = c.endereco;
        clienteEditando = i;
      };

      const btnExcluir = document.createElement('button');
      btnExcluir.className = 'excluir';
      btnExcluir.textContent = 'Excluir';
      btnExcluir.onclick = () => {
        if (confirm("Excluir cliente?")) {
          clientes.splice(i, 1);
          localStorage.setItem('clientes', JSON.stringify(clientes));
          listarClientes();
        }
      };

      acoes.appendChild(btnEditar);
      acoes.appendChild(btnExcluir);
      li.appendChild(div);
      li.appendChild(acoes);
      lista.appendChild(li);
    });
  }

  function salvarPedido() {
    const nome = pedidoCliente.value.trim();
    const produto = tipoProduto.value.trim();
    const valor = parseFloat(valorPedido.value);
    const entrega = formaEntrega.value;
    const data = dataEntrega.value;
    if (!nome || !produto || isNaN(valor) || !data) return alert('Preencha todos os campos');
    const pedidos = JSON.parse(localStorage.getItem('pedidos') || '[]');
    pedidos.push({ nome, produto, valor, entrega, data });
    localStorage.setItem('pedidos', JSON.stringify(pedidos));
    pedidoCliente.value = tipoProduto.value = valorPedido.value = dataEntrega.value = '';
    listarPedidos(); atualizarFinanceiro();
  }

  function listarPedidos() {
    const lista = document.getElementById('listaPedidos');
    lista.innerHTML = '';
    const pedidos = JSON.parse(localStorage.getItem('pedidos') || '[]');
    const filtro = document.getElementById('filtroPedido').value.toLowerCase();
    const ordem = document.getElementById('ordenarPedido').value;

    let filtrados = pedidos.filter(p => 
      p.nome.toLowerCase().includes(filtro) ||
      p.produto.toLowerCase().includes(filtro)
    );

    if (ordem === 'alfabetico') {
      filtrados.sort((a, b) => a.nome.localeCompare(b.nome));
    } else {
      filtrados.reverse(); // mais recente primeiro
    }

    filtrados.forEach(p => {
      const li = document.createElement('li');
      li.textContent = `${p.nome} - ${p.produto} - R$${p.valor.toFixed(2)} (${p.entrega}) - Entrega: ${p.data}`;
      lista.appendChild(li);
    });
  }

  function salvarDespesa() {
    const tipo = tipoDespesa.value;
    const valor = parseFloat(valorDespesa.value);
    if (!tipo || isNaN(valor)) return alert('Preencha todos os campos');
    const despesas = JSON.parse(localStorage.getItem('despesas') || '[]');
    despesas.push({ tipo, valor });
    localStorage.setItem('despesas', JSON.stringify(despesas));
    valorDespesa.value = '';
    listarDespesas(); atualizarFinanceiro();
  }

  function listarDespesas() {
    const lista = document.getElementById('listaDespesas');
    lista.innerHTML = '';
    const despesas = JSON.parse(localStorage.getItem('despesas') || '[]');
    despesas.forEach(d => {
      const li = document.createElement('li');
      li.textContent = `${d.tipo} - R$${d.valor.toFixed(2)}`;
      lista.appendChild(li);
    });
  }

  function adicionarProduto() {
    const nome = produtoNome.value.trim();
    const qtd = parseInt(produtoQtd.value);
    if (!nome || isNaN(qtd)) return alert('Preencha todos os campos');
    const estoque = JSON.parse(localStorage.getItem('estoque') || '[]');
    estoque.push({ nome, qtd });
    localStorage.setItem('estoque', JSON.stringify(estoque));
    produtoNome.value = produtoQtd.value = '';
    listarEstoque();
  }

  function listarEstoque() {
    const termo = document.getElementById('filtroEstoque').value.toLowerCase();
    const lista = document.getElementById('listaEstoque');
    lista.innerHTML = '';
    const estoque = JSON.parse(localStorage.getItem('estoque') || '[]');
    estoque.filter(e => e.nome.toLowerCase().includes(termo)).forEach(e => {
      const li = document.createElement('li');
      li.textContent = `${e.nome} - ${e.qtd} unidade(s)${e.qtd === 0 ? ' (Em falta)' : ''}`;
      lista.appendChild(li);
    });
  }

  function atualizarFinanceiro() {
    const pedidos = JSON.parse(localStorage.getItem('pedidos') || '[]');
    const despesas = JSON.parse(localStorage.getItem('despesas') || '[]');
    const ganhos = pedidos.reduce((soma, p) => soma + p.valor, 0);
    const gastos = despesas.reduce((soma, d) => soma + d.valor, 0);
    const lucros = ganhos - gastos;
    document.getElementById('ganhos').textContent = ganhos.toFixed(2);
    document.getElementById('gastos').textContent = gastos.toFixed(2);
    document.getElementById('lucros').textContent = lucros.toFixed(2);
  }

  function atualizarTudo() {
    listarClientes();
    listarPedidos();
    listarDespesas();
    listarEstoque();
    atualizarFinanceiro();
  }
</script>

</body>
</html>
