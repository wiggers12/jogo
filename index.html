<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Doce Sabor Caseiro</title>
  <style>
    /* --- CSS Inserido Aqui --- */
    body {
      font-family: Arial, sans-serif;
      margin: 0; 
      padding: 0;
      background-color: #ffeef2; /* Rosa claro */
      color: #333;
      overflow-x: hidden; /* Evita scroll horizontal */
    }

    header {
      background: #e91e63; /* Rosa mais escuro */
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
    }

    nav {
      display: flex;
      justify-content: center;
      background: #fff;
      border-bottom: 2px solid #e91e63; /* Rosa mais escuro */
      flex-wrap: wrap;
      padding: 10px 0; /* Espaçamento para botões menores */
    }

    nav button {
      background: none;
      border: none;
      padding: 10px 15px; /* Padding ajustado */
      font-size: 15px; /* Tamanho da fonte ajustado */
      cursor: pointer;
      color: #e91e63; /* Rosa mais escuro */
      transition: background-color 0.3s ease, color 0.3s ease;
      white-space: nowrap; /* Evita quebra de linha nos botões */
    }

    nav button:hover, 
    nav button.active {
      background-color: #e91e63; /* Rosa mais escuro */
      color: white;
      border-radius: 5px 5px 0 0;
    }

    main {
      padding: 20px;
      max-width: 1000px;
      margin: 0 auto;
    }

    section { 
      display: none; 
      animation: fadeIn 0.5s ease-in-out; /* Animação ao mostrar seção */
    }

    section.active { 
      display: block; 
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    input, select, textarea {
      font-size: 16px;
      padding: 10px; /* Padding um pouco maior */
      margin: 5px 0 15px 0;
      width: 100%;
      box-sizing: border-box;
      border: 1px solid #ffb3c1; /* Rosa claro para bordas */
      border-radius: 4px;
    }

    .form-actions {
        display: flex;
        gap: 10px; /* Espaço entre os botões */
        justify-content: flex-start;
        margin-top: 15px;
    }

    button.primary {
      background-color: #e91e63; /* Rosa mais escuro */
      color: white;
      border: none;
      cursor: pointer;
      padding: 12px 20px; /* Padding horizontal maior */
      border-radius: 4px;
      font-weight: bold;
      width: auto;
      transition: background-color 0.3s ease;
    }

    button.primary:hover {
      background-color: #c2185b; /* Tom de rosa mais escuro no hover */
    }

    button.primary.cancel-button {
        background-color: #ccc; /* Cor cinza para cancelar */
        color: #333;
    }
    button.primary.cancel-button:hover {
        background-color: #a0a0a0;
    }


    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
    }

    th, td {
      border: 1px solid #ffb3c1; /* Rosa claro para bordas da tabela */
      padding: 10px;
      text-align: left;
    }

    th {
      background-color: #e91e63; /* Rosa mais escuro */
      color: white;
    }

    .table-wrapper { 
        overflow-x: auto; /* Permite scroll horizontal em tabelas grandes */
        border-radius: 8px; /* Bordas arredondadas na tabela */
        box-shadow: 0 2px 5px rgba(0,0,0,0.05); /* Sombra suave */
    }

    .action-buttons {
      display: flex;
      gap: 8px; /* Espaçamento entre os botões de ação */
    }

    .action-buttons button {
      width: auto;
      padding: 8px 12px;
      margin: 0;
      font-size: 14px;
      background-color: #f7a4b6; /* Rosa mais suave para botões de ação */
      color: #333;
      border: 1px solid #e91e63;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    .action-buttons button:hover {
        background-color: #e91e63;
        color: white;
    }

    /* Estilos para o Splash Screen */
    #splash-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #fce4ec; /* Rosa bem claro para o splash */
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 1000;
      opacity: 1;
      visibility: visible;
      transition: opacity 1s ease-out, visibility 1s ease-out;
    }
    #splash-screen.fade-out {
      opacity: 0;
      visibility: hidden;
    }
    #splash-screen h1 {
      color: #e91e63; /* Rosa mais escuro */
      font-size: 3em;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }
    #splash-screen .spinner {
      border: 6px solid #f3f3f3; /* Light grey */
      border-top: 6px solid #e91e63; /* Rosa mais escuro */
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .info-card {
        background-color: #fff;
        border: 1px solid #ffb3c1;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .info-card h3 {
        color: #e91e63;
        margin-top: 0;
        font-size: 1.2em;
    }
    .info-card p {
        font-size: 1.8em;
        font-weight: bold;
        color: #c2185b;
        margin: 5px 0;
    }
    .daily-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Ajustado para 250px */
        gap: 20px;
        margin-top: 20px;
    }

    /* Responsividade para telas menores */
    @media (max-width: 768px) {
        nav {
            flex-direction: column;
            align-items: center;
        }
        nav button {
            width: 90%;
            margin-bottom: 5px;
            border-radius: 4px;
        }
        main {
            padding: 10px;
        }
        .daily-summary {
            grid-template-columns: 1fr; /* Uma coluna em telas muito pequenas */
        }
        input, select, textarea {
            font-size: 14px;
        }
    }
  </style>
</head>
<body>

  <div id="splash-screen">
    <h1>Doce Sabor Caseiro</h1>
    <div class="spinner"></div>
  </div>

  <header>Doce Sabor Caseiro</header>
  <nav>
    <button id="btn-clientes" class="active">Clientes</button>
    <button id="btn-agenda">Agenda de Pedidos</button>
    <button id="btn-estoque">Estoque</button>
    <button id="btn-gastos">Gastos com Produtos</button>
    <button id="btn-financeiro">Financeiro</button>
    <button id="btn-vendas-diarias">Vendas do Período</button>
  </nav>
  <main>
    <section id="clientes" class="active">
      <h2>Cadastro de Clientes</h2>
      <form id="form-clientes">
        <label for="cliente-nome">Nome:</label>
        <input type="text" id="cliente-nome" required />
        <label for="cliente-telefone">Telefone:</label>
        <input type="tel" id="cliente-telefone" />
        <label for="cliente-observacoes">Observações:</label>
        <textarea id="cliente-observacoes"></textarea>
        <div class="form-actions">
            <button type="submit" class="primary" id="btn-submit-cliente">Salvar Cliente</button>
        </div>
      </form>
      <div class="table-wrapper">
        <table id="tabela-clientes">
            <thead>
                <tr><th>Nome</th><th>Telefone</th><th>Observações</th><th>Ações</th></tr>
            </thead>
            <tbody id="tabela-clientes-body"></tbody>
        </table>
      </div>
    </section>

    <section id="agenda">
      <h2>Agenda de Pedidos</h2>
      <form id="form-agenda">
        <label for="pedido-cliente">Cliente:</label>
        <input type="text" id="pedido-cliente" required />
        <label for="pedido-data">Data da Entrega:</label>
        <input type="date" id="pedido-data" required />
        <label for="pedido-tipo">Tipo de Bolo:</label>
        <input type="text" id="pedido-tipo" required />
        <label for="pedido-tamanho">Tamanho:</label>
        <select id="pedido-tamanho" required>
          <option value="">Selecione</option>
          <option>Pequeno</option>
          <option>Médio</option>
          <option>Grande</option>
        </select>
        <label for="pedido-valor">Valor (R$):</label>
        <input type="number" id="pedido-valor" step="0.01" required />
        <div class="form-actions">
            <button type="submit" class="primary" id="btn-submit-pedido">Adicionar Pedido</button>
        </div>
      </form>
      <div class="table-wrapper">
        <table id="tabela-agenda">
            <thead>
                <tr><th>Cliente</th><th>Data</th><th>Tipo</th><th>Tamanho</th><th>Valor</th><th>Ações</th></tr>
            </thead>
            <tbody id="tabela-agenda-body"></tbody>
        </table>
      </div>
    </section>

    <section id="estoque">
      <h2>Estoque de Ingredientes</h2>
      <form id="form-estoque">
        <label for="ingrediente-nome">Ingrediente:</label>
        <input type="text" id="ingrediente-nome" required />
        <label for="ingrediente-quantidade">Quantidade:</label>
        <input type="number" id="ingrediente-quantidade" required />
        <div class="form-actions">
            <button type="submit" class="primary" id="btn-submit-estoque">Adicionar Ingrediente</button>
        </div>
      </form>
      <div class="table-wrapper">
        <table id="tabela-estoque">
            <thead>
                <tr><th>Ingrediente</th><th>Quantidade</th><th>Ações</th></tr>
            </thead>
            <tbody id="tabela-estoque-body"></tbody>
        </table>
      </div>
    </section>

    <section id="gastos">
      <h2>Gastos com Produtos</h2>
      <form id="form-gastos">
        <label for="gasto-produto">Produto Comprado:</label>
        <input type="text" id="gasto-produto" required />
        <label for="gasto-quantidade">Quantidade:</label>
        <input type="number" id="gasto-quantidade" required />
        <label for="gasto-valor">Valor Total (R$):</label>
        <input type="number" id="gasto-valor" step="0.01" required />
        <div class="form-actions">
            <button type="submit" class="primary" id="btn-submit-gasto">Registrar Gasto</button>
        </div>
      </form>
      <div class="table-wrapper">
        <table id="tabela-gastos">
            <thead>
                <tr><th>Produto</th><th>Quantidade</th><th>Valor</th><th>Ações</th></tr>
            </thead>
            <tbody id="tabela-gastos-body"></tbody>
        </table>
      </div>
    </section>

    <section id="financeiro">
      <h2>Resumo Financeiro</h2>
      <p><strong>Total de Ganhos:</strong> R$ <span id="ganhos">0.00</span></p>
      <p><strong>Total de Gastos:</strong> R$ <span id="gastos">0.00</span></p>
      <p><strong>Lucro:</strong> R$ <span id="lucro">0.00</span></p>
    </section>

    <section id="vendas-diarias">
        <h2>Vendas do Período</h2>
        <div class="daily-summary">
            <div class="info-card">
                <h3>Vendas do Dia</h3>
                <p>R$ <span id="vendas-dia">0.00</span></p>
            </div>
            <div class="info-card">
                <h3>Vendas da Semana</h3>
                <p>R$ <span id="vendas-semana">0.00</span></p>
            </div>
            <div class="info-card">
                <h3>Vendas do Mês</h3>
                <p>R$ <span id="vendas-mes">0.00</span></p>
            </div>
        </div>
    </section>
  </main>

  <script>
    /* --- JavaScript Inserido Aqui --- */

    // --- Elementos DOM ---
    const botoesNav = document.querySelectorAll("nav button");
    const secoes = document.querySelectorAll("main section");
    const splashScreen = document.getElementById("splash-screen");

    // --- Variáveis de Estado (para edição) ---
    let editingItemIndex = -1;
    let editingStorageKey = ''; // 'clientes', 'agenda', 'estoque', 'gastos'

    // --- Mapeamentos para formulários (ID do campo no formulário) ---
    const formMappings = {
        clientes: {
            formId: 'form-clientes',
            tableBodyId: 'tabela-clientes-body',
            submitBtnId: 'btn-submit-cliente',
            formActionsId: 'cliente-form-actions',
            itemSingularName: 'cliente',
            inputMap: {
                nome: 'cliente-nome',
                telefone: 'cliente-telefone',
                observacoes: 'cliente-observacoes'
            }
        },
        agenda: {
            formId: 'form-agenda',
            tableBodyId: 'tabela-agenda-body',
            submitBtnId: 'btn-submit-pedido',
            formActionsId: 'pedido-form-actions',
            itemSingularName: 'pedido',
            inputMap: {
                cliente: 'pedido-cliente',
                data: 'pedido-data',
                tipo: 'pedido-tipo',
                tamanho: 'pedido-tamanho',
                valor: 'pedido-valor'
            }
        },
        estoque: {
            formId: 'form-estoque',
            tableBodyId: 'tabela-estoque-body',
            submitBtnId: 'btn-submit-estoque',
            formActionsId: 'estoque-form-actions',
            itemSingularName: 'ingrediente',
            inputMap: {
                nome: 'ingrediente-nome',
                quantidade: 'ingrediente-quantidade'
            }
        },
        gastos: {
            formId: 'form-gastos',
            tableBodyId: 'tabela-gastos-body',
            submitBtnId: 'btn-submit-gasto',
            formActionsId: 'gasto-form-actions',
            itemSingularName: 'gasto',
            inputMap: {
                produto: 'gasto-produto',
                quantidade: 'gasto-quantidade',
                valor: 'gasto-valor'
            }
        }
    };

    // --- Funções de Utilitários ---

    // Formata valor para moeda BRL
    const formatCurrency = (value) => {
        return parseFloat(value).toFixed(2).replace('.', ',');
    };

    // Obtém dados do LocalStorage
    const getLocalStorageData = (key) => {
        return JSON.parse(localStorage.getItem(key) || "[]");
    };

    // Salva dados no LocalStorage
    const setLocalStorageData = (key, data) => {
        localStorage.setItem(key, JSON.stringify(data));
    };

    // --- Funções de UI/UX ---

    // Exibe o splash screen e o esconde após um tempo
    const setupSplashScreen = () => {
        window.addEventListener("load", () => {
            setTimeout(() => {
                splashScreen.classList.add("fade-out");
                document.body.style.overflow = "auto";
            }, 2000);
        });
    };

    // Alterna a seção ativa
    const switchSection = (sectionId) => {
        botoesNav.forEach(b => b.classList.remove("active"));
        secoes.forEach(s => s.classList.remove("active"));
        
        const targetButton = document.getElementById(`btn-${sectionId}`);
        const targetSection = document.getElementById(sectionId);

        if (targetButton) targetButton.classList.add("active");
        if (targetSection) targetSection.classList.add("active");
        
        // Atualiza resumos ao trocar de seção
        atualizarFinanceiro();
        atualizarVendasPeriodo();
    };

    // --- Funções Genéricas de CRUD ---

    // Carrega dados e constrói a tabela
    const carregarDados = (config) => {
        const { storageKey, tableBodyId, itemHtmlBuilder } = config;
        const dados = getLocalStorageData(storageKey);
        const tableBody = document.getElementById(tableBodyId);

        if (tableBody) { // Garante que o elemento exista antes de tentar manipulá-lo
            tableBody.innerHTML = "";
            dados.forEach((item, i) => {
                tableBody.innerHTML += itemHtmlBuilder(item, i);
            });
        }
        resetForm(config); // Reseta o formulário após carregar
    };

    // Inicia o modo de edição
    const editarItem = (storageKey, index) => {
        const config = formMappings[storageKey];
        if (!config) {
            console.error('Configuração não encontrada para:', storageKey);
            return;
        }

        const dados = getLocalStorageData(storageKey);
        const item = dados[index];
        const submitButton = document.getElementById(config.submitBtnId);
        const formActions = document.querySelector(`#${config.formId} .form-actions`); // Pega o div de ações dentro do formulário

        // Preenche o formulário
        for (const key in config.inputMap) {
            const inputElement = document.getElementById(config.inputMap[key]);
            if (inputElement) {
                inputElement.value = item[key];
            }
        }
        
        let submitButtonText = `Atualizar ${config.itemSingularName.charAt(0).toUpperCase() + config.itemSingularName.slice(1)}`;
        if (config.itemSingularName === 'gasto') submitButtonText = "Atualizar Gasto"; 
        if (config.itemSingularName === 'cliente') submitButtonText = "Salvar Alterações"; 
        if (submitButton) {
            submitButton.textContent = submitButtonText;
            submitButton.classList.add("edit-mode");
        }
        
        // Adiciona o botão de cancelar se não existir
        const cancelButtonId = `btn-cancel-${config.formId.replace('form-', '')}`;
        if (formActions && !document.getElementById(cancelButtonId)) {
            const cancelButton = document.createElement("button");
            cancelButton.textContent = "Cancelar";
            cancelButton.type = "button";
            cancelButton.id = cancelButtonId;
            cancelButton.classList.add("primary", "cancel-button"); 
            cancelButton.onclick = () => resetForm(config);
            formActions.appendChild(cancelButton);
        }

        editingItemIndex = index; 
        editingStorageKey = storageKey;
    };

    // Reseta o formulário e sai do modo de edição
    const resetForm = (config) => {
        const formElement = document.getElementById(config.formId);
        if (formElement) formElement.reset();
        
        const submitButton = document.getElementById(config.submitBtnId);
        let buttonText = `Adicionar ${config.itemSingularName.charAt(0).toUpperCase() + config.itemSingularName.slice(1)}`;
        if (config.itemSingularName === 'gasto') buttonText = "Registrar Gasto"; 
        if (config.itemSingularName === 'cliente') buttonText = "Salvar Cliente"; 
        if (submitButton) {
            submitButton.textContent = buttonText;
            submitButton.classList.remove("edit-mode");
        }

        const cancelButton = document.getElementById(`btn-cancel-${config.formId.replace('form-', '')}`);
        if (cancelButton) {
            cancelButton.remove();
        }
        editingItemIndex = -1; 
        editingStorageKey = '';
    };

    // Exclui um item
    const excluirItem = (storageKey, index) => {
        const config = formMappings[storageKey];
        if (!config) {
            console.error('Configuração não encontrada para:', storageKey);
            return;
        }
        const dados = getLocalStorageData(storageKey);
        dados.splice(index, 1);
        setLocalStorageData(storageKey, dados);
        
        carregarDados(config); // Recarrega a tabela específica
        atualizarFinanceiro(); // Atualiza financeiro
        atualizarVendasPeriodo(); // Atualiza vendas do período
    };

    // --- Funções Específicas de Conteúdo e Lógica ---

    // Builders de HTML para as tabelas
    const clienteHtmlBuilder = (c, i) => `
        <tr>
            <td>${c.nome}</td>
            <td>${c.telefone}</td>
            <td>${c.observacoes}</td>
            <td>
                <div class="action-buttons">
                    <button onclick="editarItem('clientes', ${i})">Editar</button>
                    <button onclick="excluirItem('clientes', ${i})">Excluir</button>
                </div>
            </td>
        </tr>`;

    const pedidoHtmlBuilder = (a, i) => `
        <tr>
            <td>${a.cliente}</td>
            <td>${a.data}</td>
            <td>${a.tipo}</td>
            <td>${a.tamanho}</td>
            <td>R$ ${formatCurrency(a.valor)}</td>
            <td>
                <div class="action-buttons">
                    <button onclick="editarItem('agenda', ${i})">Editar</button>
                    <button onclick="excluirItem('agenda', ${i})">Excluir</button>
                </div>
            </td>
        </tr>`;

    const ingredienteHtmlBuilder = (e, i) => `
        <tr>
            <td>${e.nome}</td>
            <td>${e.quantidade}</td>
            <td>
                <div class="action-buttons">
                    <button onclick="editarItem('estoque', ${i})">Editar</button>
                    <button onclick="excluirItem('estoque', ${i})">Excluir</button>
                </div>
            </td>
        </tr>`;

    const gastoHtmlBuilder = (g, i) => `
        <tr>
            <td>${g.produto}</td>
            <td>${g.quantidade}</td>
            <td>R$ ${formatCurrency(g.valor)}</td>
            <td>
                <div class="action-buttons">
                    <button onclick="editarItem('gastos', ${i})">Editar</button>
                    <button onclick="excluirItem('gastos', ${i})">Excluir</button>
                </div>
            </td>
        </tr>`;

    // --- Configuração dos Formulários ---
    const setupForm = (config) => {
        const formElement = document.getElementById(config.formId);
        if (!formElement) return; // Garante que o formulário exista

        formElement.onsubmit = (e) => {
            e.preventDefault();
            
            let newItem = {};
            for (const key in config.inputMap) {
                const inputElement = document.getElementById(config.inputMap[key]);
                if (inputElement) {
                    newItem[key] = inputElement.value;
                }
            }
            
            // Validação básica para valores numéricos
            if (newItem.valor !== undefined && isNaN(parseFloat(newItem.valor))) {
                alert('Por favor, insira um valor numérico válido para o valor.');
                return;
            }
            if (newItem.quantidade !== undefined && isNaN(parseInt(newItem.quantidade))) {
                alert('Por favor, insira uma quantidade numérica válida.');
                return;
            }

            let data = getLocalStorageData(config.storageKey);

            if (editingItemIndex !== -1 && editingStorageKey === config.storageKey) {
                data[editingItemIndex] = newItem;
            } else {
                data.push(newItem);
            }
            setLocalStorageData(config.storageKey, data);
            
            carregarDados(config); // Recarrega a tabela e reseta o formulário
            atualizarFinanceiro(); // Atualiza painéis de resumo
            atualizarVendasPeriodo();
        };
    };

    // --- Funções de Resumo ---

    const atualizarFinanceiro = () => {
        const agenda = getLocalStorageData("agenda");
        const gastos = getLocalStorageData("gastos");

        const ganhos = agenda.reduce((s, p) => s + parseFloat(p.valor || 0), 0);
        const despesas = gastos.reduce((s, g) => s + parseFloat(g.valor || 0), 0);
        const lucro = ganhos - despesas;

        document.getElementById("ganhos").textContent = formatCurrency(ganhos);
        document.getElementById("gastos").textContent = formatCurrency(despesas);
        document.getElementById("lucro").textContent = formatCurrency(lucro);
    };

    const atualizarVendasPeriodo = () => {
        const agenda = getLocalStorageData("agenda");
        // Usando a data atual fixa: 10 de julho de 2025 para consistência nos testes
        // Para usar a data real do sistema, substitua por `new Date()`
        const hoje = new Date('2025-07-10T00:00:00'); 
        hoje.setHours(0, 0, 0, 0); 

        // Vendas do Dia
        const vendasDia = agenda.reduce((total, pedido) => {
            const dataPedido = new Date(pedido.data + 'T00:00:00'); 
            dataPedido.setHours(0, 0, 0, 0);
            if (dataPedido.getTime() === hoje.getTime()) {
                return total + parseFloat(pedido.valor || 0);
            }
            return total;
        }, 0);
        document.getElementById("vendas-dia").textContent = formatCurrency(vendasDia);

        // Vendas da Semana (Domingo a Sábado)
        const inicioSemana = new Date(hoje);
        inicioSemana.setDate(hoje.getDate() - hoje.getDay()); // Define para o último domingo (0 = domingo)
        inicioSemana.setHours(0, 0, 0, 0);

        const fimSemana = new Date(inicioSemana);
        fimSemana.setDate(inicioSemana.getDate() + 6); // Define para o próximo sábado
        fimSemana.setHours(23, 59, 59, 999);

        const vendasSemana = agenda.reduce((total, pedido) => {
            const dataPedido = new Date(pedido.data + 'T00:00:00');
            dataPedido.setHours(0, 0, 0, 0);
            if (dataPedido >= inicioSemana && dataPedido <= fimSemana) {
                return total + parseFloat(pedido.valor || 0);
            }
            return total;
        }, 0);
        document.getElementById("vendas-semana").textContent = formatCurrency(vendasSemana);

        // Vendas do Mês
        const inicioMes = new Date(hoje.getFullYear(), hoje.getMonth(), 1);
        const fimMes = new Date(hoje.getFullYear(), hoje.getMonth() + 1, 0); // Último dia do mês
        fimMes.setHours(23, 59, 59, 999);

        const vendasMes = agenda.reduce((total, pedido) => {
            const dataPedido = new Date(pedido.data + 'T00:00:00');
            dataPedido.setHours(0, 0, 0, 0);
            if (dataPedido >= inicioMes && dataPedido <= fimMes) {
                return total + parseFloat(pedido.valor || 0);
            }
            return total;
        }, 0);
        document.getElementById("vendas-mes").textContent = formatCurrency(vendasMes);
    };

    // --- Inicialização ---
    document.addEventListener("DOMContentLoaded", () => {
        setupSplashScreen();

        // Adiciona o evento de click aos botões de navegação
        botoesNav.forEach(botao => {
            botao.addEventListener("click", () => switchSection(botao.id.replace("btn-", "")));
        });

        // Anexa as funções genéricas ao objeto window para acesso global (onclick em HTML)
        window.editarItem = editarItem;
        window.excluirItem = excluirItem;

        // Configura os formulários
        setupForm({ ...formMappings.clientes, storageKey: 'clientes' });
        setupForm({ ...formMappings.agenda, storageKey: 'agenda' });
        setupForm({ ...formMappings.estoque, storageKey: 'estoque' });
        setupForm({ ...formMappings.gastos, storageKey: 'gastos' });

        // Inicia o carregamento dos dados para todas as tabelas
        carregarDados({ ...formMappings.clientes, storageKey: 'clientes', itemHtmlBuilder: clienteHtmlBuilder });
        carregarDados({ ...formMappings.agenda, storageKey: 'agenda', itemHtmlBuilder: pedidoHtmlBuilder });
        carregarDados({ ...formMappings.estoque, storageKey: 'estoque', itemHtmlBuilder: ingredienteHtmlBuilder });
        carregarDados({ ...formMappings.gastos, storageKey: 'gastos', itemHtmlBuilder: gastoHtmlBuilder });

        // Atualiza os painéis de resumo
        atualizarFinanceiro();
        atualizarVendasPeriodo();
    });
  </script>
</body>
</html>
